<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Kitap Arama</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    #search-bar { margin-bottom: 20px; }
    #sonuclar .result-item {
      display: flex;
      align-items: center;
      padding: 4px 0;
      border-bottom: 1px solid #ddd;
    }
    .result-item-number { width: 30px; }
    .result-item-text { flex: 1; }
    .google-search img { width: 20px; cursor: pointer; }
  </style>
</head>
<body>

  <div id="search-bar">
    <input type="text" id="aramaInput" placeholder="Aramak istediğin metni yaz..." />
    <button id="searchButton">Ara</button>
  </div>

  <div id="sonuclar"></div>

  <script>
    let kitaplar = [];

    // 1) kitaplar.json'u yükle
    fetch('kitaplar.json')
      .then(resp => resp.json())
      .then(data => { 
        kitaplar = data; 
      })
      .catch(err => {
        console.error('kitaplar.json yüklenemedi:', err);
        document.getElementById('sonuclar').textContent = 
          'Veri yüklenirken hata oluştu. Lütfen terminalden bir HTTP sunucu (ör. python -m http.server) çalıştır ve bu sayfayı http://localhost:8000 üzerinden aç.';
      });

    // 2) Arama düğmesine basılınca
    document.getElementById('searchButton').addEventListener('click', displayResults);

    function displayResults() {
      const term = document.getElementById('aramaInput')
                         .value.trim().toLowerCase();
      const out = document.getElementById('sonuclar');
      out.innerHTML = '';      
      if (!term) {
        out.textContent = 'Lütfen önce bir arama terimi gir.';
        return;
      }

      const filtered = kitaplar.filter(k => 
        k.toLowerCase().includes(term)
      );

      if (filtered.length === 0) {
        out.textContent = 'Eşleşen sonuç bulunamadı.';
        return;
      }

      filtered.forEach((item, i) => {
        const idx = i + 1;
        const div = document.createElement('div');
        div.className = 'result-item';

        const num = document.createElement('div');
        num.className = 'result-item-number';
        num.textContent = idx + '.';

        const txt = document.createElement('div');
        txt.className = 'result-item-text';
        txt.textContent = item;

        // Google butonu
        const a = document.createElement('a');
        a.className = 'google-search';
        a.href = 'https://www.google.com/search?q=' 
                 + encodeURIComponent(item);
        a.target = '_blank';
        const img = document.createElement('img');
        img.src = 'googlelogo.webp';
        img.alt = 'Google’da Ara';
        a.appendChild(img);

        div.appendChild(num);
        div.appendChild(txt);
        div.appendChild(a);
        out.appendChild(div);
      });
    }
  </script>

</body>
</html>